package TestCasesCRM;

import java.util.List;

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.annotations.Test;
import org.testng.asserts.SoftAssert;

import BrowsersBase.DataInterface;
import CommonMethods.WebDriverWaits;

public class Dashboard extends SubmissionSettings{
	
	
	public static By CRMToggle = By.xpath("//div[@class='multi-choice-buttons']/button[2]");
	public static By SLAHeader = By.xpath("//div[@class='dashboard__widgets-holder dashboard__widgets-holder--cases']/h2");
	public static By AssignedForMeLink = By.xpath("//div[@class='widget widget--all-dashboard']/a/label");
	public static By MineButton = By.xpath("//button[text()='Mine']");
	public static By ForMyDepartMentLink = By.xpath("//div[@class='widget widget--all-dashboard'][2]//label");
	public static By ForMyAgency = By.xpath("//div[@class='widget widget--all-dashboard'][3]//label");
	public static By CountAtLink1 = By.xpath("//div[@class='widget widget--all-dashboard']//a/span[1]");
	public static By CountAtLink2 = By.xpath("(//div[@class='widget widget--all-dashboard']//a/span[1])[2]");
	public static By CountAtLink3 = By.xpath("(//div[@class='widget widget--all-dashboard']//a/span[1])[3]");
	public static By SubmissionID = By.xpath("//span[@class='checkbox-holder']/following::a[1]");

	public static int CountAtCSLPForLink1;
	public static int CountAtCSLPForLink2;
	public static int CountAtCSLPForLink3;
	
	 @Test(priority = 1)
	public static void Dashboard_VerifyCRMToggleButton() throws InterruptedException {
		extentTest = extent.startTest(" Dashboard_VerifyCRMToggleButton ");
		extentTest.setDescription(" Verify that 'CRM' toggle button appears beside 'Dashboard' header, on 'Dashboard' page. ");
		SoftAssert softAssert = new SoftAssert();
		driver.navigate().to(DataInterface.URLDashboard);
		Thread.sleep(3000);
		String CRMToggleText = WebDriverWaits.GetText(CRMToggle);
		softAssert.assertEquals(CRMToggleText, "CRM");
		softAssert.assertAll();
	}

	 @Test(priority = 2)
	public static void Dashboard_VerifyDirectionToCRMDashboard() throws InterruptedException {
		extentTest = extent.startTest(" Dashboard_VerifyDirectionToCRMDashboard ");
		extentTest.setDescription(" Verify that user gets directed to CRM Dashboard, after clicking on 'CRM' toggle button, on Dashboard. ");
		SoftAssert softAssert = new SoftAssert();
		WebDriverWaits.ClickOn(CRMToggle);
		Thread.sleep(3000);
		String SLAHeaderText = WebDriverWaits.GetText(SLAHeader);
		softAssert.assertEquals(SLAHeaderText, "SLA");	
		softAssert.assertAll();
	}

	 @Test(priority = 3)
	public static void Dashboard_VerifyDirectionToCSLPForAssignedToMELink() throws InterruptedException {
		extentTest = extent.startTest(" Dashboard_VerifyDirectionToCSLPForAssignedToMELink ");
		extentTest.setDescription(" Verify that user gets directed to CSLP with respective Filter applied, after clicking on 'Open submission assigned for me' link, on Dashboard. ");
		SoftAssert softAssert = new SoftAssert();
		WebDriverWaits.ClickOn(AssignedForMeLink);
		Thread.sleep(3000);
		boolean CheckButtonState = WebDriverWaits.WaitUntilVisibleWE(MineButton).isEnabled();
		softAssert.assertTrue(CheckButtonState);
		List<WebElement> AllSubmissionsID = driver.findElements(SubmissionID);
		CountAtCSLPForLink1 = AllSubmissionsID.size();
		softAssert.assertAll();
	}

	 @Test(priority = 4)
	public static void Dashboard_VerifyDirectionToCSLPForMyDepartment() throws InterruptedException {
		extentTest = extent.startTest(" Dashboard_VerifyDirectionToCSLPForMyDepartment ");
		extentTest.setDescription(" Verify that user gets directed to CSLP with respective Filter applied, after clicking on 'Open submissions for my department' link, on Dashboard. ");
		SoftAssert softAssert = new SoftAssert();
		driver.navigate().to(DataInterface.URLDashboard);
		Thread.sleep(3000);
		WebDriverWaits.ClickOn(CRMToggle);
		Thread.sleep(3000);
		WebDriverWaits.ClickOn(ForMyDepartMentLink);		
		Thread.sleep(3000);
		List<WebElement> AllSubmissionsID = driver.findElements(SubmissionID);
		CountAtCSLPForLink2 = AllSubmissionsID.size();
		softAssert.assertAll();
	}

	 @Test(priority = 5)
	public static void Dashboard_VerifyDirectionToCSLPForMyAgency() throws InterruptedException {
		extentTest = extent.startTest(" Dashboard_VerifyDirectionToCSLPForMyAgency ");
		extentTest.setDescription(" Verify that user gets directed to CSLP with respective Filter applied, after clicking on 'Open submissions for my agency' link, on Dashboard. ");
		SoftAssert softAssert = new SoftAssert();
		driver.navigate().to(DataInterface.URLDashboard);
		Thread.sleep(3000);
		WebDriverWaits.ClickOn(CRMToggle);
		Thread.sleep(3000);
		WebDriverWaits.ClickOn(ForMyAgency);
		Thread.sleep(3000);
		List<WebElement> AllSubmissionsID = driver.findElements(SubmissionID);
		CountAtCSLPForLink3 = AllSubmissionsID.size();
		softAssert.assertAll();
	}

	 @Test(priority = 6)
	public static void Dashboard_VerifyTheCountOfSubmissions() throws InterruptedException {
		extentTest = extent.startTest(" Dashboard_VerifyTheCountOfSubmissions ");
		extentTest.setDescription(" Verify that accurate count of Submissions appears on CSLP, when user clicks on respective link on Dashboard. ");
		SoftAssert softAssert = new SoftAssert();
		driver.navigate().to(DataInterface.URLDashboard);
		Thread.sleep(3000);
		WebDriverWaits.ClickOn(CRMToggle);
		Thread.sleep(3000);
		String SubCountForAssignedToMe = WebDriverWaits.GetText(CountAtLink1);
		String SubCountForMyDepartment = WebDriverWaits.GetText(CountAtLink2);
		String SubCountForMyAgency = WebDriverWaits.GetText(CountAtLink3);
		softAssert.assertEquals(SubCountForAssignedToMe, CountAtCSLPForLink1);
		softAssert.assertEquals(SubCountForMyDepartment, CountAtCSLPForLink2);
		softAssert.assertEquals(SubCountForMyAgency, CountAtCSLPForLink3);
		softAssert.assertAll();
	}


}
